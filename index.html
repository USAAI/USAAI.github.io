
<!DOCTYPE html> 
<html lang="zh"> 
<head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>WWZ 知识竞赛</title> 
    <style> 
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #1e1e2f, #3a3a5e); 
            color: white; 
            padding: 20px; 
            margin: 0; 
            min-height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
        } 
 
        .container { 
            background: rgba(255, 255, 255, 0.1); 
            padding: 20px; 
            border-radius: 20px; 
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.2); 
            width: 100%; 
            max-width: 800px; 
            text-align: center; 
        } 
 
        h1 { 
            font-size: 2rem; 
            margin-bottom: 20px; 
            font-weight: 700; 
            letter-spacing: 1px; 
        } 
 
        #category-select { 
            background: rgba(255,255,255,0.2); 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 8px; 
            margin-bottom: 20px; 
            font-size: 16px; 
            appearance: none; 
            -webkit-appearance: none; 
            -moz-appearance: none; 
            background-image: url('data:image/svg+xml;utf8,<svg fill="white" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'); 
            background-repeat: no-repeat; 
            background-position: right 10px center; 
            width: 100%; 
            max-width: 300px; 
        } 
 
        #category-select option { 
            background-color: #3a3a5e; 
            color: white; 
        } 
 
        #question { 
            font-size: 1.4rem; 
            margin: 20px 0; 
            min-height: 60px; 
        } 
 
        .button-container { 
            display: grid; 
            grid-template-columns: 1fr; 
            gap: 10px; 
            margin: 20px 0; 
        } 
 
        .option-btn { 
            background: #00b0ff; 
            padding: 15px; 
            border-radius: 12px; 
            transition: all 0.2s ease; 
            font-size: 1rem; 
            width: 100%; 
            box-sizing: border-box; 
        } 
 
        .option-btn:hover:not(:disabled) { 
            transform: translateY(-2px); 
            box-shadow: 0 4px 15px rgba(0, 176, 255, 0.4); 
        } 
 
        #controls { 
            margin-top: 20px; 
            display: flex; 
            flex-direction: column; 
            gap: 10px; 
        } 
 
        .control-btn { 
            background: #6c5ce7; 
            padding: 12px 20px; 
            border-radius: 10px; 
            font-size: 1rem; 
            width: 100%; 
            max-width: 200px; 
            margin: 0 auto; 
        } 
 
        #result { 
            font-size: 1rem; 
            margin-top: 20px; 
        } 
 
        #loading { 
            font-size: 1rem; 
            margin-top: 20px; 
        } 
 
        @media (min-width: 600px) { 
            .button-container { 
                grid-template-columns: 1fr 1fr; 
            } 
 
            #controls { 
                flex-direction: row; 
                justify-content: center; 
            } 
 
            .control-btn { 
                width: auto; 
            } 
        } 
    </style> 
</head> 
<body> 
<div class="container"> 
    <h1>WWZ 知识竞赛</h1> 
     
    <select id="category-select" onchange="changeCategory()"> 
        <option value="vocabulary">词汇竞赛</option> 
        <option value="poetry">古诗词竞赛</option> 
        <option value="history">历史竞赛</option> 
        <option value="idioms">成语竞赛</option> 
    </select> 
 
    <p id="question" class="fade-in">加载中...</p> 
    <div id="options" class="button-container"></div> 
     
    <div id="controls"> 
        <button class="control-btn" onclick="fetchNextQuestion()">下一题</button> 
        <button class="control-btn" onclick="showExplanation()">查看解析</button> 
    </div> 
 
    <p id="result"></p> 
    <p id="loading" style="display:none;">正在加载题目，请稍等...</p> 
</div> 
 
<script> 
    const apiKey = "e6b918f22001b0f6676c39118f0252f7.W5OVT2M0wIfNFzTh"; 
    const apiUrl = "https://open.bigmodel.cn/api/paas/v4/chat/completions"; 
 
    let currentCategory = "vocabulary"; 
    let currentQuiz = null; 
 
    function changeCategory() { 
        const select = document.getElementById("category-select"); 
        currentCategory = select.value; 
        document.getElementById("result").innerText = ""; 
        fetchNextQuestion(); 
    } 
 
    function fetchNextQuestion() { 
        document.getElementById("result").innerText = ""; 
        document.getElementById("options").innerHTML = ""; 
        document.getElementById("question").innerText = "加载中..."; 
        document.getElementById("loading").style.display = "block"; 
 
        fetchQuestion(); 
    } 
 
    function fetchQuestion() {  
        const categoryPrompts = {  
            vocabulary: "从高考3500词中选择一个单词，给出该单词的中文意思或固定搭配，要求选择正确的答案",  
            poetry: "生成一道古诗词竞赛题目，给出一句诗或诗的上一句/下一句，要求选择正确的下句/上句",  
            history: "从中外古今历史事件中，选出一些事件，让用户选出对此事件的正确评价",  
            idioms: "给出成语，让用户选出正确的成语释义"   
        };  
  
        const randomSeed = Math.random().toString(36).substring(7); // 生成随机字符串  
  
        fetch(apiUrl, {  
            method: "POST",  
            headers: {  
                "Content-Type": "application/json",  
                "Authorization": `Bearer ${apiKey}`  
            },  
            body: JSON.stringify({  
                model: "glm-4-flash",  
                messages: [{  
                    role: "user",  
                    content: `${categoryPrompts[currentCategory]} (随机数:${randomSeed})。选项格式必须为：{  
                        "question": "题目内容",  
                        "options": ["A. 选项1", "B. 选项2", "C. 选项3", "D. 选项4"],  
                        "answer": "A. 选项1",  
                        "explanation": "详细解析说明"  
                    }`  
                }]  
            })  
        })  
        .then(response => response.json())  
        .then(data => {  
            const quiz = JSON.parse(data.choices[0].message.content);  
            currentQuiz = quiz;  
            displayQuestion(quiz);  
            document.getElementById("loading").style.display = "none";  
        })  
        .catch(error => {  
            console.error("Error:", error);  
            setTimeout(fetchQuestion, 2000);  
        });  
    } 
 
    function displayQuestion(quiz) { 
        document.getElementById("question").innerText = quiz.question; 
        const optionsDiv = document.getElementById("options"); 
        optionsDiv.innerHTML = ""; 
 
        quiz.options.forEach(option => { 
            const btn = document.createElement("button"); 
            btn.className = "option-btn"; 
            btn.innerText = option; 
            btn.onclick = () => checkAnswer(option, quiz.answer, btn); 
            optionsDiv.appendChild(btn); 
        }); 
    } 
 
    function checkAnswer(selected, correct, button) { 
        const buttons = document.querySelectorAll('.option-btn'); 
        const selectedLetter = selected.split(".")[0].trim(); 
        const correctLetter = correct.split(".")[0].trim(); 
 
        const result = document.getElementById("result"); 
        if (selectedLetter === correctLetter) { 
            result.innerHTML = "🎉 答对啦！<br>解析：" + currentQuiz.explanation; 
            result.style.color = "#00ff00"; 
            button.style.background = '#00ff00'; 
        } else { 
            result.innerHTML = `😢 正确答案：${correct}<br>解析：${currentQuiz.explanation}`; 
            result.style.color = "#ff0000"; 
            button.style.background = '#ff0000'; 
 
            const correctBtn = Array.from(buttons).find(btn =>  
                btn.innerText.split(".")[0].trim() === correctLetter 
            ); 
            if (correctBtn) correctBtn.style.background = '#00ff00'; 
        } 
    } 
 
    function showExplanation() { 
        if (currentQuiz) { 
            document.getElementById("result").innerHTML =  
                `📚 题目解析：<br>${currentQuiz.explanation}`; 
            document.getElementById("result").style.color = "#00b0ff"; 
        } 
    } 
 
    fetchNextQuestion(); 
</script> 
</body> 
</html>
